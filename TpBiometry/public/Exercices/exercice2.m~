    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                    TP 1 -- IMSECU                      %
    %                        06/03/18                        %
    %                                                        %
    % Camille PLAYS & William CLOT                Exercice 2 %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% REMINDER : PLEASE EXECUTE exercice1.m BEFORE EXECUTING THIS FILE

%      Part A      
%%%%%%%%%%%%%%%%%%%%

test_A = loadImagesInDirectory('../Images/test_A/');
test_projection = projectImages(test_A, Means, SpaceA);
FigureHandle6 = plotFirst3Coordinates(test_projection, 5, 5);


%      Part B      
%%%%%%%%%%%%%%%%%%%%

figureHandle7 = approximateImage('../Images/test_A/s1_6.jpg',Means,SpaceA,10);


%      Part C      
%%%%%%%%%%%%%%%%%%%%

figure('Name','Identification rate with first face','NumberTitle','off')
model_first = model_projection(1:5:end,:); %Tacking only the first face of the models
firstface_rate=zeros(1,100);

for i=1:100 %Computing the identification rates
    firstface_rate(i) = identify(model_first,test_projection,i,1);
end

plot(firstface_rate)
xlabel('Number of eigenfaces')
ylabel('Identification rate')

hold on %Adding the maximum value
[firstface_max, firstface_index] = max(firstface_rate);
x=[indice,indice];
y=[0,firstface_max];
plot(x,y);
hold off
%%%%%%%%%%%%%%%%%%%%
%      Part D      %
%%%%%%%%%%%%%%%%%%%%

model_average = zeros(1,20);
mean_rate=zeros(1,100);

for i = 0:19
    for j = 1:100
        model_average(i+1,j) = (model_projection(5*i+1,j)+model_projection(5*i+2,j)+model_projection(5*i+3,j)+model_projection(5*i+4,j)+model_projection(5*i+5,j))/5;
    end
end

for i=1:100
    mean_rate(i) = identify(model_average,test_projection,i,1);
end

hold off
figure();

xlabel('number of eigenfaces')
ylabel('identification rate (mean faces)')

[firstface_max, indice] = max(mean_rate);
x=[indice,indice];
y=[0,firstface_max];

plot(mean_rate);
hold on
plot(x,y);

%%%%%%%%%%%%%%%%%%%%
%      Part E      %
%%%%%%%%%%%%%%%%%%%%

Nbest_rate=zeros(1,5);

for i=1:5
    Nbest_rate(i) = identify(model_projection,test_projection,5,i);
end

hold off
figure()

xlabel('Nbest')
ylabel('best identification rate')


plot(Nbest_rate);

